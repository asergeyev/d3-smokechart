!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-shape")):"function"==typeof define&&define.amd?define(["exports","d3-shape"],t):t((e=e||self).d3=e.d3||{},e.d3)}(this,(function(e,t){"use strict";const a=(e,t)=>{if(t<0||t>1||isNaN(t))throw new Error(`Unable to calculate ${t} quantile`);var a=(e.length-1)*t,r=Math.floor(a),l=a-r;return l<.001?e[r]:Math.floor(e[r]*(1-l)+e[r+1]*l+.5)},r=[[],[[0,1]],[[0,1],[.25,.75]],[[0,1],[.15,.85],[.3,.7]],[[0,1],[.1,.9],[.2,.8],[.3,.7]],[[0,1],[.1,.9],[.2,.8],[.3,.7],[.4,.6]]],l=(e,t)=>r[t].map(([t,r])=>[a(e,t),a(e,r)]);e.Smokechart=(e,r)=>{const n={};let s=[],c=Math.floor(1e5*Math.random());const o=(e,t)=>(e&&!Array.isArray(e)&&(t=e,e=void 0),t&&Object.assign(n,t),e&&o.data(e),c=Math.floor(1e5*Math.random()),o);return o.data=e=>e?(s=e.map(e=>[...e.filter(e=>!isNaN(e))].sort((e,t)=>e-t)),o):s,o.adjustScaleRange=()=>{if(n.scaleX&&n.scaleX.domain([0,s.length]),!n.scaleY)return;let e=1/0,t=-1/0;return s.forEach(a=>{a.length&&(a[0]<e&&(e=a[0]),a[a.length-1]>t&&(t=a[a.length-1]))}),n.scaleY.domain([e,t]),o},o.scaleX=e=>e?(n.scaleX=e,o):n.scaleX,o.scaleY=e=>e?(n.scaleY=e,o):n.scaleY,o.line=(e=.5)=>[t.line().x(e=>n.scaleX?n.scaleX(e[0]):e[0]).y(e=>n.scaleY?n.scaleY(e[1]):e[1])(s.reduce((t,r,l)=>{const n=a(r,e);return[...t,[l-.5,n],[l+.5,n]]},[]))],o.smokeBands=(e=2)=>{const a=t.line().x(e=>n.scaleX?n.scaleX(e[0]):e[0]).y(e=>n.scaleY?n.scaleY(e[1]):e[1]),r=s.reduce((t,r,n)=>{const s=l(r,e),c=n-.5;return[...t,s.map(([e,t])=>a([[c,e],[c,t],[c+1,t],[c+1,e]])||"")]},[]);return r[0].map((e,t)=>r.map(e=>e[t]).join(""))},o.countErrors=(e=-1)=>{const t=s.map(e=>e.length),a=e>=0?e:Math.max(...t);return t.map(e=>a>e?a-e:0).reduce((e,t,a)=>{if(t>0){const r=[],l=n.scaleX?n.scaleX(a):a;for(let e=0;e<t;e++)r.push({x:l,errPos:e});return[...e,...r]}return e},[])},o.chart=(e,t)=>{if((null==t?void 0:t.bands)&&e.selectAll("path.smokechart-band"+c).data(o.smokeBands(null==t?void 0:t.bands)).enter().append("path").classed("smokechart-band",!0).attr("fill","rgba(0,0,0,0.18)").attr("d",e=>e),e.selectAll("path.smokechart-line"+c).data(o.line(.5)).enter().append("path").classed("smokechart-line",!0).attr("stroke","#ff0000").attr("stroke-width",1.1).attr("fill","transparent").attr("d",e=>e),null==t?void 0:t.errors){const t=o.countErrors()||[];t.length&&e.selectAll("circle.smokechart-baseline"+c).data(t).enter().append("circle").attr("cx",e=>e.x).attr("cy",e=>3+4.5*e.errPos).attr("r",2).attr("fill","#f30")}},o(e,r)},e.calculateSmokeBands=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=d3-smokechart.min.js.map
